<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Administrativo - IZETA 2025</title>
    
    <!-- CSS Externo -->
    <link rel="stylesheet" href="css/dashboard.css">
    
    <!-- CSS B√°sico inline mientras no exista dashboard.css -->
    <style>
        /* CSS M√≠nimo para que funcione sin el archivo externo */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f9fafb; }
        .dashboard-layout { display: grid; grid-template-columns: 260px 1fr; min-height: 100vh; }
        .sidebar { background: #1f2937; color: white; padding: 1rem; }
        .main-content { padding: 1rem; }
        .loading { text-align: center; padding: 3rem; }
        .loading-spinner { width: 50px; height: 50px; border: 4px solid #f3f4f6; border-top: 4px solid #1e3a8a; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .nav-item { display: block; padding: 0.75rem; color: white; text-decoration: none; margin: 0.25rem 0; border-radius: 6px; cursor: pointer; }
        .nav-item:hover { background: rgba(255,255,255,0.1); }
        .nav-item.active { background: #1e3a8a; }
        .error-container { background: #fee2e2; border: 1px solid #dc2626; color: #991b1b; padding: 1.5rem; border-radius: 8px; margin: 1rem 0; }
    </style>
</head>
<body>
    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <span>‚ôî</span>
                    <span>IZETA 2025</span>
                </div>
                <div class="sidebar-user">
                    <span>üë§</span>
                    <span id="currentUserEmail">Cargando...</span>
                </div>
            </div>
            
            <nav class="nav-section">
                <div class="nav-section-title">PRINCIPAL</div>
                <a href="#overview" class="nav-item active" data-page="overview">
                    <span class="nav-icon">üìä</span>
                    <span>Vista General</span>
                </a>
                <a href="#students" class="nav-item" data-page="students">
                    <span class="nav-icon">üë•</span>
                    <span>Gesti√≥n de Alumnos</span>
                    <span class="nav-badge" id="totalStudentsBadge">0</span>
                </a>
                <a href="#results" class="nav-item" data-page="results">
                    <span class="nav-icon">üìà</span>
                    <span>Resultados</span>
                </a>
                <a href="#simulations" class="nav-item" data-page="simulations">
                    <span class="nav-icon">üéØ</span>
                    <span>Simulacros</span>
                </a>
                
                <div class="nav-section-title" style="margin-top: 2rem;">AVANZADO</div>
                <a href="#alerts" class="nav-item" data-page="alerts">
                    <span class="nav-icon">üîî</span>
                    <span>Alertas</span>
                    <span class="nav-badge" id="alertsBadge" style="display: none;">0</span>
                </a>
                <a href="#analytics" class="nav-item" data-page="analytics">
                    <span class="nav-icon">üìä</span>
                    <span>An√°lisis y Tendencias</span>
                </a>
                <a href="#medals" class="nav-item" data-page="medals">
                    <span class="nav-icon">üèÖ</span>
                    <span>Medallas y Logros</span>
                </a>
                <a href="#risk" class="nav-item" data-page="risk">
                    <span class="nav-icon">‚ö†Ô∏è</span>
                    <span>An√°lisis de Riesgo</span>
                </a>
            </nav>
                <div class="nav-section-title" style="margin-top: 2rem;">HERRAMIENTAS</div>
                <a href="#bulk-users" class="nav-item" data-page="bulk-users">
                    <span class="nav-icon">üë•</span>
                    <span>Carga Masiva</span>
                </a>
                <a href="#elo-manual" class="nav-item" data-page="elo-manual">
                    <span class="nav-icon">‚ö°</span>
                    <span>ELO Manual</span>
                </a>
            <nav class="nav-section" style="margin-top: auto; padding-bottom: 2rem;">
                <a href="#" class="nav-item" onclick="logout()">
                    <span class="nav-icon">üö™</span>
                    <span>Cerrar Sesi√≥n</span>
                </a>
            </nav>
        </aside>
        
        <!-- Contenido principal -->
        <main class="main-content">
            <!-- Header principal -->
            <header class="main-header">
                <div class="header-left">
                    <h1 class="page-title" id="pageTitle">Vista General</h1>
                    <nav class="breadcrumb">
                        <span>Dashboard</span>
                        <span>/</span>
                        <span id="breadcrumbCurrent">Vista General</span>
                    </nav>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshData()">
                        üîÑ Actualizar
                    </button>
// Cambiar de:
                    <button class="btn btn-primary" onclick="window.location.href='bulk-users.html'">
                        ‚ûï A√±adir alumnos
                    </button>

                    // A:
                    <button class="btn btn-primary" onclick="window.dashboardAdmin.showPage('bulk-users')">
                        ‚ûï A√±adir alumnos
                    </button>
                </div>
            </header>
            
            <!-- Barra de filtros -->
            <div class="filters-bar" id="filtersBar">
                <div class="filter-group">
                    <label class="filter-label">Cohorte:</label>
                    <select id="cohortFilter" class="btn btn-secondary" onchange="applyFilters()">
                        <option value="all">Todas</option>
                        <option value="20h">20h - Base</option>
                        <option value="36h">36h - Intensivo</option>
                        <option value="48h">48h - √âlite</option>
                        <option value="sin_asignar">Sin asignar</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Estado:</label>
                    <select id="statusFilter" class="btn btn-secondary" onchange="applyFilters()">
                        <option value="all">Todos</option>
                        <option value="active">Activos</option>
                        <option value="inactive">Inactivos</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Per√≠odo:</label>
                    <select id="dateRangeFilter" class="btn btn-secondary" onchange="applyFilters()">
                        <option value="all">Todo</option>
                        <option value="week">√öltima semana</option>
                        <option value="month">√öltimo mes</option>
                        <option value="quarter">√öltimo trimestre</option>
                    </select>
                </div>
            </div>
            
            <!-- Contenido din√°mico -->
            <div class="content-wrapper" id="contentWrapper">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p style="margin-top: 1rem;">Cargando dashboard...</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Configuraci√≥n de Supabase -->
    <script src="../assets/js/config.js"></script>
    
    <!-- M√≥dulos del Dashboard -->
    <script type="module" src="js/dashboard-init.js"></script>
    
    <!-- Quick Debug Console -->
    <script>
        // Consola de debug para desarrollo
        console.log('%cüéØ IZETA 2025 - Dashboard Admin', 'font-size: 20px; color: #1e3a8a;');
        console.log('Para debug, usa: window.dashboardAdmin');
        console.log('Comandos disponibles:');
        console.log('- dashboardAdmin.getInstance() - Obtener instancia del dashboard');
        console.log('- dashboardAdmin.refreshData() - Refrescar datos');
        console.log('- dashboardAdmin.showPage("students") - Cambiar de p√°gina');
        console.log('- dashboardAdmin.exportData("csv") - Exportar datos');
    </script>
</body>
</html>